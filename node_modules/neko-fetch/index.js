const axios = require("axios");

async function ttdl(url) {
    try {
        let apiUrl = `https://nekoapi.web.id/download/tiktok-download?url=${encodeURIComponent(url)}`;
        let { data } = await axios.get(apiUrl);

        if (!data.success) return `Gagal mengambil data: ${data.message}`;

        let result = {
            creator: data.creator,
            message: data.message,
            video: data.data.video.map(v => ({
                resolution: v.resolution,
                link: v.link
            })),
            audio: data.data.audio.map(a => ({
                format: a.format,
                link: a.link
            }))
        };

        return result;
    } catch (error) {
        return `Error: ${error.message}`;
    }
}

// Export module
module.exports = { ttdl };
